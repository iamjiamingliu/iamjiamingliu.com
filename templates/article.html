{% extends "base.html" %}
{% block title %}{{ article.metadata.title }} · Jiaming Liu{% endblock %}

{% block content %}
    <div class="container py-4 py-md-5">
        <div class="row g-4 g-lg-5 align-items-start">
            {# Main article #}
            <div class="{% if article.table_of_content %}col-lg-8{% else %}col-lg-10 me-auto{% endif %}">
                <header class="mb-4">
                    <div class="d-flex flex-wrap align-items-center gap-2 mb-2">
                        <a class="text-decoration-none small text-muted" href="{{ url_for('blogs') }}">← Blogs</a>
                        <span class="text-muted">·</span>
                        <span class="badge text-bg-secondary">{{ article.metadata.category }}</span>
                    </div>

                    <h1 class="display-6 fw-semibold mb-2">{{ article.metadata.title }}</h1>

                    <div class="d-flex flex-wrap align-items-center gap-2 text-muted small mb-3">
                        <span>Created {{ article.metadata.created_at.strftime('%b %d, %Y') }}</span>
                        <span class="text-muted">·</span>
                        <span>Updated {{ article.metadata.updated_at.strftime('%b %d, %Y') }}</span>
                    </div>

                    {% if article.metadata.tags %}
                        <div class="d-flex flex-wrap gap-2 mb-3">
                            {% for tag in article.metadata.tags %}
                                <a class="badge rounded-pill text-bg-light border text-decoration-none"
                                   href="{{ url_for('blogs', tag=tag) }}">
                                    #{{ tag }}
                                </a>
                            {% endfor %}
                        </div>
                    {% endif %}
                </header>
                <article class="article-content">
                    {{ article.content | safe }}
                </article>
            </div>

            {# Table of contents (optional) #}
            {% if article.table_of_content %}
                <div class="col-lg-4">
                    <div class="sticky-top" style="top: 1.25rem;">
                        <div class="border rounded-4 p-3 p-md-4 bg-body">
                            <div class="fw-semibold mb-2">Table of content</div>
                            <div class="toc small">
                                {{ article.table_of_content | safe }}
                            </div>
                        </div>
                    </div>
                </div>
            {% endif %}
        </div>
    </div>

    {# Optional: light opinionated styling for markdown-rendered HTML #}
    <style>
        .article-content :where(h1,h2,h3,h4,h5,h6) {
            scroll-margin-top: 90px;
        }

        .article-content h2 {
            margin-top: 2rem;
        }

        .article-content h3 {
            margin-top: 1.5rem;
        }

        .article-content p {
            line-height: 1.75;
            margin: 0.9rem 0;
        }

        .article-content img {
            max-width: 100%;
            height: auto;
            border-radius: 1rem;
        }

        .article-content pre {
            padding: 1rem;
            border-radius: 1rem;
            overflow-x: auto;
        }

        .article-content code {
            padding: 0.15rem 0.35rem;
            border-radius: 0.4rem;
        }

        .article-content blockquote {
            padding-left: 1rem;
            border-left: 0.25rem solid rgba(0, 0, 0, .15);
            color: rgba(0, 0, 0, .7);
        }

        .toc a {
            color: inherit;
            text-decoration: none;
        }

        .toc a:hover {
            text-decoration: underline;
        }

        .toc ul {
            padding-left: 1.0rem;
            margin-bottom: 0;
        }
    </style>
{% endblock %}
